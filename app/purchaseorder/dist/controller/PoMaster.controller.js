sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Filter"],function(e,t){"use strict";return e.extend("sp.fiori.purchaseorder.controller.PoMaster",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.router=sap.ui.core.UIComponent.getRouterFor(this);this._listTemp=this.getView().byId("listItemTemp").clone();this.flagModel=sap.ui.getCore().getModel("flagModel");this.oDataModel=sap.ui.getCore().getModel("oDataModel");this.filterModel=new sap.ui.model.json.JSONModel;this.router.attachRoutePatternMatched(this.handleRouteMatched,this)},handleRouteMatched:function(e){if(e.getParameter("name")!=="PoMaster"){return}var t=this;var s=sessionStorage.getItem("unitCode")||"P01";this.AddressCodePO=sessionStorage.getItem("AddressCodePO")||"ATE-01-01";if(t.flagModel.getData().confirmPressFlag){var i=this.getView().byId("masterListId").getSelectedItem();this.getView().byId("searchFieldId").setValue("");this.getView().byId("masterListId").getBinding("items").filter([]);this.getView().byId("masterListId").setSelectedItem(i,true);var r=t.getView().byId("masterListId");var a=i.getBindingContext().getProperty("PoNum");var o=a.replace(/\//g,"-");t.router.navTo("PoDetail",{Po_No:o});return}this.getView().byId("searchFieldId").setValue("");this.getView().byId("masterListId").bindItems({path:"/PurchaseOrders",parameters:{custom:{AddressCode:this.AddressCodePO,UnitCode:s},countMode:"None"},template:this._listTemp});this._getFirstItem()},_getFirstItem:function(){var e=this;sap.ui.core.BusyIndicator.show(0);this.getView().byId("masterListId").getBinding("items").attachDataReceived(function(){var t=e.getView().byId("masterListId");var s=t.getItems()[0];if(s){t.setSelectedItem(s,true);var i=s.getBindingContext().getProperty("PoNum");var r=i.replace(/\//g,"-");e.router.navTo("PoDetail",{Po_No:r});sap.ui.core.BusyIndicator.hide()}else{e.router.navTo("NoData")}sap.ui.core.BusyIndicator.hide()});sap.ui.core.BusyIndicator.hide()},onListItemPress:function(e){if(this.getView().byId("masterListId").getMode()=="MultiSelect"){return}var t=e.getParameter("listItem").getProperty("title");var s=t.replace(/\//g,"-");this.router.navTo("PoDetail",{Po_No:s})},onSearch:function(e){var t=sessionStorage.getItem("unitCode");if(e.getParameter("refreshButtonPressed")===true){this.getView().byId("masterListId").getBinding("items").refresh(true);this._getFirstItem()}else{var s=e.getParameter("query");if(s){this.getView().byId("masterListId").bindItems({path:"/PurchaseOrders?search="+s,parameters:{custom:{unitCode:t}},template:this._listTemp})}else{this.getView().byId("masterListId").bindItems({path:"/PurchaseOrders",parameters:{custom:{unitCode:t}},template:this._listTemp})}this._getFirstItem()}},onListModeChange:function(){var e=this.getView().byId("masterListId").getMode();if(e=="SingleSelectMaster"){this.getView().byId("masterListId").setMode("MultiSelect")}else{this.getView().byId("masterListId").setMode("SingleSelectMaster")}}})});